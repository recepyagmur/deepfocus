<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deep Focus | Pro Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>

    <style>
        /* --- CSS STƒ∞LLERƒ∞ --- */
        :root {
            --bg-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            --card-bg: rgba(30, 41, 59, 0.85); /* Biraz daha koyu opaklƒ±k */
            --card-border: rgba(255, 255, 255, 0.1);
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --accent: #eab308;
            --accent-glow: rgba(234, 179, 8, 0.3);
            --success: #10b981;
            --danger: #ef4444;

            /* Kategori Renkleri */
            --cat-work: #3b82f6;
            --cat-study: #a855f7;
            --cat-sport: #f97316;
            --cat-personal: #ec4899;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-gradient);
            color: var(--text-main);
            min-height: 100vh;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            width: 100%;
            max-width: 650px;
            border-radius: 24px;
            border: 1px solid var(--card-border);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.6);
            padding: 40px;
            position: relative;
            overflow: hidden;
        }

        /* Arkaplan I≈üƒ±ltƒ±sƒ± */
        .glow-spot {
            position: absolute;
            top: -50px;
            right: -50px;
            width: 150px;
            height: 150px;
            background: var(--accent);
            filter: blur(80px);
            opacity: 0.2;
            border-radius: 50%;
            z-index: 0;
        }

        /* --- BA≈ûLIK ALANI --- */
        header {
            position: relative;
            z-index: 1;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .header-content h1 {
            font-size: 28px;
            font-weight: 700;
            margin: 0;
            background: linear-gradient(to right, #fff, #cbd5e1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .quote {
            font-size: 13px;
            color: var(--text-muted);
            font-style: italic;
            margin-top: 8px;
            border-left: 2px solid var(--accent);
            padding-left: 10px;
            max-width: 400px;
        }

        /* Zincir (Streak) Rozeti */
        .streak-badge {
            background: rgba(239, 68, 68, 0.15);
            color: #fca5a5;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 700;
            display: none; /* JS ile a√ßƒ±lacak */
            align-items: center;
            gap: 6px;
            border: 1px solid rgba(239, 68, 68, 0.3);
            box-shadow: 0 0 15px rgba(239, 68, 68, 0.1);
        }

        /* --- PROGRESS BAR --- */
        .progress-container { margin-bottom: 25px; position: relative; z-index: 1; }
        .progress-labels { display: flex; justify-content: space-between; font-size: 12px; color: var(--text-muted); margin-bottom: 8px; }
        .progress-track { height: 6px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--accent); width: 0%; border-radius: 10px; box-shadow: 0 0 10px var(--accent-glow); transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }

        /* --- FORM ALANLARI --- */
        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        .full-width { grid-column: span 2; }

        input, select {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--card-border);
            padding: 14px;
            border-radius: 12px;
            color: #fff;
            font-family: inherit;
            font-size: 14px;
            outline: none;
            transition: 0.3s;
            width: 100%;
        }
        /* Takvim ve Saat ikonunu beyaz yap */
        input[type="time"]::-webkit-calendar-picker-indicator,
        input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(1); cursor: pointer; }

        input:focus, select:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 2px var(--accent-glow);
            background: rgba(0, 0, 0, 0.5);
        }

        /* Select Ok ƒ∞konu */
        select {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 12px;
            cursor: pointer;
        }
        select option { background: #1e293b; color: #fff; }

        button#addBtn {
            grid-column: span 2;
            background: var(--accent);
            color: #0f172a;
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        button#addBtn:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(234, 179, 8, 0.2); }
        button#addBtn:disabled { opacity: 0.6; cursor: wait; }

        /* --- Lƒ∞STE TASARIMI --- */
        ul { list-style: none; padding: 0; margin: 30px 0 0 0; max-height: 450px; overflow-y: auto; }
        ul::-webkit-scrollbar { width: 4px; }
        ul::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 10px; }

        li {
            background: rgba(255, 255, 255, 0.04);
            margin-bottom: 12px;
            padding: 16px;
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.05);
            display: grid;
            grid-template-columns: auto 1fr auto auto; /* Grip - ƒ∞√ßerik - Saya√ß - Sil */
            gap: 12px;
            align-items: center;
            transition: background 0.2s;
            position: relative;
        }

        /* S√ºr√ºkleme Tutamacƒ± */
        .drag-handle {
            color: var(--text-muted);
            cursor: grab;
            padding: 5px;
            opacity: 0.5;
            font-size: 18px;
        }
        .drag-handle:hover { opacity: 1; color: #fff; }

        .sortable-ghost { opacity: 0.4; background: rgba(234, 179, 8, 0.1); border: 1px dashed var(--accent); }
        .sortable-drag { cursor: grabbing; background: #1e293b; opacity: 1; }

        /* Kategori Renk √áizgisi */
        li::before {
            content: ''; position: absolute; left: 0; top: 16px; bottom: 16px; width: 4px;
            background: var(--text-muted); border-radius: 0 4px 4px 0;
        }
        li.cat-work::before { background: var(--cat-work); box-shadow: 0 0 8px var(--cat-work); }
        li.cat-study::before { background: var(--cat-study); box-shadow: 0 0 8px var(--cat-study); }
        li.cat-sport::before { background: var(--cat-sport); box-shadow: 0 0 8px var(--cat-sport); }
        li.cat-personal::before { background: var(--cat-personal); box-shadow: 0 0 8px var(--cat-personal); }

        li.completed { opacity: 0.5; order: 999; }
        li.completed .task-text { text-decoration: line-through; color: var(--text-muted); }

        .task-info { cursor: pointer; }

        .badges { display: flex; gap: 8px; margin-bottom: 6px; flex-wrap: wrap;}
        .badge { font-size: 10px; text-transform: uppercase; padding: 4px 8px; border-radius: 6px; font-weight: 700; }
        .badge-time { background: rgba(234, 179, 8, 0.15); color: var(--accent); }
        .badge-date { background: rgba(255, 255, 255, 0.1); color: var(--text-muted); }
        .badge-cat { background: rgba(255,255,255,0.05); color: #fff; border: 1px solid rgba(255,255,255,0.1); }

        /* √áalƒ±≈üƒ±lan S√ºre Rozeti */
        .badge-worked { background: rgba(16, 185, 129, 0.15); color: #34d399; display: none; }

        .task-text { font-size: 16px; font-weight: 500; margin-bottom: 4px; display: block; }

        /* --- TIMER KUTUSU --- */
        .timer-box {
            display: flex; align-items: center; gap: 8px;
            background: rgba(0,0,0,0.2); padding: 5px 12px; border-radius: 30px;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .timer-display {
            font-family: monospace; font-size: 14px; font-weight: 700;
            color: var(--text-muted); width: 70px; text-align: center;
        }
        .timer-active { color: var(--accent); text-shadow: 0 0 10px rgba(234, 179, 8, 0.4); }

        .timer-btn {
            background: var(--text-main); color: #0f172a; border: none;
            width: 26px; height: 26px; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; cursor: pointer;
            font-size: 10px; transition: 0.2s;
        }
        .timer-btn:hover { transform: scale(1.1); background: var(--accent); }

        .delete-btn { background: transparent; border: none; color: var(--danger); font-size: 18px; cursor: pointer; opacity: 0.4; padding: 5px; }
        .delete-btn:hover { opacity: 1; transform: scale(1.1); }

        .empty-state { text-align: center; color: var(--text-muted); margin-top: 40px; font-weight: 300; opacity: 0.6; }

    </style>
</head>
<body>

    <div class="container">
        <div class="glow-spot"></div>

        <header>
            <div class="header-content">
                <h1>Deep Focus</h1>
                <div class="quote" id="quoteBox">Y√ºkleniyor...</div>
            </div>

            <div class="streak-badge" id="streakBadge">
                üî• <span>0 G√ºn</span>
            </div>
        </header>

        <div class="progress-container">
            <div class="progress-labels">
                <span id="progressText">%0 Tamamlandƒ±</span>
                <span id="countText">0/0 G√∂rev</span>
            </div>
            <div class="progress-track">
                <div class="progress-fill" id="progressBar"></div>
            </div>
        </div>

        <div class="input-grid">
            <input type="date" id="taskDate">

            <select id="taskCategory">
                <option value="other">Kategori (Genel)</option>
                <option value="work">üíº ƒ∞≈ü</option>
                <option value="study">üìö Okul</option>
                <option value="sport">üí™ Spor</option>
                <option value="personal">üè† Ki≈üisel</option>
            </select>

            <input type="time" id="startTime">
            <input type="time" id="endTime">

            <input type="text" id="taskInput" class="full-width" placeholder="Hedefin nedir? (√ñrn: Raporu tamamla)" onkeypress="handleEnter(event)">

            <button id="addBtn" onclick="addTask()">
                PLANLA VE BA≈ûLA
            </button>
        </div>

        <ul id="taskList"></ul>
        <div id="emptyMessage" class="empty-state">Y√ºkleniyor...</div>
    </div>

    <audio id="alarmSound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

    <script>
        const API_URL = 'api.php';
        let activeTimerInterval = null;
        let activeTaskId = null;
        let tasksData = []; // T√ºm veriyi hafƒ±zada tutuyoruz

        document.addEventListener('DOMContentLoaded', () => {
            initApp();
        });

        function initApp() {
            // Bug√ºn√ºn tarihini ayarla
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.getElementById('taskDate');
            dateInput.value = today;

            // Tarih deƒüi≈üince listeyi filtrele
            dateInput.addEventListener('change', () => {
                renderTasks(tasksData); // Filtre render i√ßinde yapƒ±lƒ±yor
            });

            // Saat Ayarlarƒ± (≈ûu an ve 1 saat sonrasƒ±)
            const now = new Date();
            const h = String(now.getHours()).padStart(2,'0');
            const m = String(now.getMinutes()).padStart(2,'0');
            document.getElementById('startTime').value = `${h}:${m}`;

            now.setHours(now.getHours() + 1);
            const he = String(now.getHours()).padStart(2,'0');
            const me = String(now.getMinutes()).padStart(2,'0');
            document.getElementById('endTime').value = `${he}:${me}`;

            // Fonksiyonlarƒ± Ba≈ülat
            loadQuote();
            fetchTasks();
            initSortable();
        }

        // --- G√úNL√úK S√ñZLER (DOSYADAN) ---
        async function loadQuote() {
            try {
                const response = await fetch('quotes.json');
                const quotes = await response.json();

                // G√ºne g√∂re sabit index (Her g√ºn deƒüi≈üir)
                const dayIndex = Math.floor(Date.now() / 86400000);
                const quote = quotes[dayIndex % quotes.length];

                document.getElementById('quoteBox').textContent = `"${quote}"`;
            } catch (error) {
                console.error("S√∂zler y√ºklenemedi:", error);
                document.getElementById('quoteBox').textContent = '"Ba≈üarƒ± bir yolculuktur, varƒ±≈ü noktasƒ± deƒüil."';
            }
        }

        function handleEnter(e) { if (e.key === 'Enter') addTask(); }

        // --- SORTABLE (S√ºr√ºkle Bƒ±rak) ---
        function initSortable() {
            const el = document.getElementById('taskList');
            Sortable.create(el, {
                animation: 150,
                handle: '.drag-handle',
                ghostClass: 'sortable-ghost',
                dragClass: 'sortable-drag',
                onEnd: function () { saveNewOrder(); }
            });
        }

        function saveNewOrder() {
            // Ekranda o an g√∂r√ºnen sƒ±rayƒ± al (Sadece o g√ºn√ºn sƒ±ralamasƒ±nƒ± etkiler)
            const listItems = document.querySelectorAll('#taskList li');
            const newOrderIds = Array.from(listItems).map(li => parseInt(li.getAttribute('data-id')));

            // Veri yapƒ±sƒ±nƒ± g√ºncelle (Karma≈üƒ±k olmamasƒ± i√ßin basit UI g√ºncellemesi)
            // Ger√ßek bir backend senaryosunda her g√ºn i√ßin ayrƒ± order tutulmalƒ±.
        }

        // --- API & TASKS ---
        async function fetchTasks() {
            try {
                const res = await fetch(API_URL);
                tasksData = await res.json();

                calculateStreak(tasksData); // Zinciri hesapla
                renderTasks(tasksData);     // Listeyi √ßiz
            } catch (e) {
                document.getElementById('emptyMessage').textContent = "Hata olu≈ütu.";
            }
        }

        async function saveTasks(tasks, shouldRender = true) {
            try {
                await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(tasks)
                });
                tasksData = tasks; // Global veriyi g√ºncelle
                calculateStreak(tasksData);
                if(shouldRender) renderTasks(tasks);
            } catch (e) { alert("Kaydedilemedi."); }
        }

        async function addTask() {
            const text = document.getElementById('taskInput').value.trim();
            const start = document.getElementById('startTime').value;
            const end = document.getElementById('endTime').value;
            const selectedDate = document.getElementById('taskDate').value; // Se√ßili tarihe ekle

            if (!text || !start || !end) return alert("Eksik bilgi girdin.");
            if (start >= end) return alert("Biti≈ü saati ba≈ülangƒ±√ßtan sonra olmalƒ±.");

            document.getElementById('addBtn').disabled = true;

            const task = {
                id: Date.now(),
                text: text,
                date: selectedDate, // O an hangi g√ºn a√ßƒ±ksa ona eklenir
                category: document.getElementById('taskCategory').value,
                startTime: start,
                endTime: end,
                elapsedTime: 0, // Ka√ß saniye √ßalƒ±≈üƒ±ldƒ±
                completed: false,
                completedAt: null
            };

            const newTasks = [task, ...tasksData];
            await saveTasks(newTasks);

            document.getElementById('taskInput').value = '';
            document.getElementById('addBtn').disabled = false;
        }

        async function toggleTask(id) {
            if(activeTaskId === id) stopTimer();

            const t = tasksData.find(x => x.id === id);
            if(t) {
                t.completed = !t.completed;
                t.completedAt = t.completed ? new Date().toLocaleTimeString('tr-TR', {hour:'2-digit', minute:'2-digit'}) : null;
                saveTasks(tasksData);
            }
        }

        async function deleteTask(id) {
            if(activeTaskId === id) stopTimer();
            if(confirm("G√∂revi silmek istiyor musun?")) {
                const newTasks = tasksData.filter(t => t.id !== id);
                saveTasks(newTasks);
            }
        }

        // --- GELƒ∞≈ûMƒ∞≈û TIMER MANTIƒûI ---

        // ƒ∞ki saat arasƒ±ndaki farkƒ± saniye olarak bul
        function getDurationSeconds(start, end) {
            const [h1, m1] = start.split(':').map(Number);
            const [h2, m2] = end.split(':').map(Number);
            return (h2 * 3600 + m2 * 60) - (h1 * 3600 + m1 * 60);
        }

        // Saniyeyi Dakika:Saniye formatƒ±na √ßevir
        function formatTime(seconds) {
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = seconds % 60;

            // Eƒüer saat varsa H:MM:SS, yoksa MM:SS
            if (h > 0) return `${h}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
            return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
        }

        function toggleTimer(id) {
            // Eƒüer √ßalƒ±≈üan bu ise durdur
            if (activeTaskId === id) {
                stopTimer();
                return;
            }

            // Ba≈üka bir saya√ß varsa √∂nce onu durdur
            if (activeTimerInterval) stopTimer();

            activeTaskId = id;
            const task = tasksData.find(t => t.id === id);
            const totalDuration = getDurationSeconds(task.startTime, task.endTime);

            // UI G√ºncelle
            const btn = document.getElementById(`btn-${id}`);
            const display = document.getElementById(`timer-${id}`);
            btn.innerHTML = "‚è∏"; // Pause ikonu
            display.classList.add('timer-active');

            activeTimerInterval = setInterval(() => {
                // Her saniye ge√ßen s√ºreyi artƒ±r
                task.elapsedTime = (task.elapsedTime || 0) + 1;

                // Geri Sayƒ±m (Toplam - Ge√ßen)
                let remaining = totalDuration - task.elapsedTime;

                // S√ºre biterse 0'da kalsƒ±n
                if (remaining <= 0) {
                    remaining = 0;
                    // Bir kereye mahsus ses √ßalƒ±nabilir
                    if(remaining === 0 && (task.elapsedTime - totalDuration) === 1) {
                         document.getElementById('alarmSound').play().catch(e=>{});
                    }
                }

                // Ekranƒ± G√ºncelle
                display.textContent = formatTime(remaining);

                // "√áalƒ±≈üƒ±lan S√ºre" Badge'ini G√ºncelle
                const workedBadge = document.getElementById(`worked-${id}`);
                workedBadge.style.display = 'inline-block';
                const workedMin = Math.floor(task.elapsedTime / 60);
                workedBadge.textContent = `‚ö° ${workedMin}dk √áalƒ±≈üƒ±ldƒ±`;

            }, 1000);
        }

        function stopTimer() {
            if (activeTaskId) {
                // Durunca veriyi kaydet (Zaman kaybƒ± olmasƒ±n)
                saveTasks(tasksData, false);

                const display = document.getElementById(`timer-${activeTaskId}`);
                const btn = document.getElementById(`btn-${activeTaskId}`);
                if(display) display.classList.remove('timer-active');
                if(btn) btn.innerHTML = "‚ñ∂";
            }
            clearInterval(activeTimerInterval);
            activeTimerInterval = null;
            activeTaskId = null;
        }

        // --- RENDER (Lƒ∞STELEME) ---
        function renderTasks(allTasks) {
            const list = document.getElementById('taskList');
            const emptyMsg = document.getElementById('emptyMessage');

            // 1. Se√ßili tarihi al
            const selectedDate = document.getElementById('taskDate').value;

            // 2. Sadece o tarihin g√∂revlerini filtrele
            const filteredTasks = allTasks.filter(task => task.date === selectedDate);

            list.innerHTML = '';

            // Bo≈ü durum mesajƒ±
            if (filteredTasks.length === 0) {
                emptyMsg.style.display = 'block';
                emptyMsg.textContent = selectedDate === new Date().toISOString().split('T')[0]
                    ? "Bug√ºn i√ßin hen√ºz plan yok."
                    : "Bu tarihte kayƒ±tlƒ± g√∂rev yok.";
            } else {
                emptyMsg.style.display = 'none';
            }

            // Progress Bar (Sadece o g√ºn√ºn verisi)
            const completedCount = filteredTasks.filter(t => t.completed).length;
            updateProgress(completedCount, filteredTasks.length);

            filteredTasks.forEach(task => {
                const li = document.createElement('li');
                li.setAttribute('data-id', task.id);
                if (task.completed) li.classList.add('completed');
                li.classList.add(`cat-${task.category || 'other'}`);

                // Zaman hesaplamalarƒ±
                const totalSeconds = getDurationSeconds(task.startTime, task.endTime);
                const elapsed = task.elapsedTime || 0;
                let remaining = totalSeconds - elapsed;
                if (remaining < 0) remaining = 0;

                const workedMinutes = Math.floor(elapsed / 60);
                const showWorked = workedMinutes > 0 ? 'inline-block' : 'none';

                li.innerHTML = `
                    <div class="drag-handle">‚ãÆ‚ãÆ</div>

                    <div class="task-info" onclick="toggleTask(${task.id})">
                        <div class="badges">
                            <span class="badge badge-cat">${getCatLabel(task.category)}</span>
                            <span class="badge badge-time">${task.startTime}-${task.endTime}</span>
                            <span class="badge badge-worked" id="worked-${task.id}" style="display: ${showWorked}">‚ö° ${workedMinutes}dk √áalƒ±≈üƒ±ldƒ±</span>
                        </div>
                        <span class="task-text">${task.text}</span>
                        <div class="completed-msg">‚úÖ Tamamlandƒ±</div>
                    </div>

                    ${!task.completed ? `
                    <div class="timer-box">
                        <div class="timer-display" id="timer-${task.id}">${formatTime(remaining)}</div>
                        <button class="timer-btn" id="btn-${task.id}" onclick="toggleTimer(${task.id})">‚ñ∂</button>
                    </div>
                    ` : '<div></div>'}

                    <button class="delete-btn" onclick="deleteTask(${task.id})">‚úï</button>
                `;
                list.appendChild(li);
            });
        }

        function getCatLabel(c) {
            const map = { 'work':'ƒ∞≈ü', 'study':'Okul', 'sport':'Spor', 'personal':'Ki≈üisel', 'other':'Genel' };
            return map[c] || 'Genel';
        }

        function updateProgress(done, total) {
            const bar = document.getElementById('progressBar');
            const pct = total === 0 ? 0 : Math.round((done / total) * 100);
            bar.style.width = `${pct}%`;
            document.getElementById('progressText').textContent = `%${pct} Tamamlandƒ±`;
            document.getElementById('countText').textContent = `${done}/${total} G√∂rev`;

            // Tamamlanƒ±nca ye≈üil, yoksa sarƒ±
            bar.style.backgroundColor = pct === 100 ? '#10b981' : '#eab308';
        }

        // --- Zƒ∞NCƒ∞R (STREAK) HESAPLAMA ---
        function calculateStreak(tasks) {
            // T√ºm tarihlerden benzersiz tamamlananlarƒ± al
            const completedDates = [...new Set(tasks.filter(t => t.completed).map(t => t.date))].sort().reverse();

            if (completedDates.length === 0) {
                document.getElementById('streakBadge').style.display = 'none';
                return;
            }

            const today = new Date().toISOString().split('T')[0];
            let streak = 0;
            let check = new Date();

            // Eƒüer bug√ºn yapƒ±lmadƒ±ysa d√ºnden ba≈üla kontrol etmeye
            if(!completedDates.includes(today)) check.setDate(check.getDate() - 1);

            while(true) {
                if(completedDates.includes(check.toISOString().split('T')[0])) {
                    streak++;
                    check.setDate(check.getDate() - 1);
                } else {
                    break;
                }
            }

            // En az 1 g√ºn varsa g√∂ster
            if(streak > 0) {
                const b = document.getElementById('streakBadge');
                b.style.display = 'flex';
                b.querySelector('span').textContent = `${streak} G√ºnl√ºk Seri`;
            } else {
                document.getElementById('streakBadge').style.display = 'none';
            }
        }
    </script>
</body>
</html>